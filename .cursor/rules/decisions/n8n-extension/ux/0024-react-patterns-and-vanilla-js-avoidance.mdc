---
alwaysApply: false
description: Preferred React patterns for the extensionâ€”avoid vanilla JS and enforce React-centric approaches.
---

# Decision Record: React Patterns and Vanilla JavaScript Avoidance for n8n Extension

## Goal
Establish React-first development patterns for the n8n extension, avoiding vanilla JavaScript DOM manipulation in favor of React components and patterns.

## Core Principle
**NEVER use vanilla JavaScript DOM manipulation when React alternatives exist.**

## React Standards for n8n Extension
- **ALWAYS use React components** - Never use vanilla JavaScript DOM manipulation
- **Use functional components** with hooks (`useState`, `useEffect`, etc.)
- **Use TypeScript interfaces** for all props and state
- **Use CSS files** for component styling (co-located `.css` files next to components)
- **Use React event handlers** (`onClick`, `onChange`, `onKeyPress`, etc.)

## Component Structure Pattern
```typescript
// Component.tsx
import './Component.css'

interface ComponentProps {
    // Define all props with types
}

function Component({ prop1, prop2 }: ComponentProps): React.JSX.Element {
    const [state, setState] = React.useState<Type>(initialValue);
    
    React.useEffect(() => {
        // Effect logic
        return () => {
            // Cleanup
        };
    }, [dependencies]);
    
    return (
        <div className="component">
            {/* JSX content */}
        </div>
    );
}

// Component.css
.component {
    padding: var(--spacing-xs, 0.75rem);
    background: var(--color-background-base, #2d2e3a);
}
```

## Styling Standards
- **CSS files co-located with components** - Create `.css` file next to each `.tsx` file
- **Use CSS classes** - Apply styles via `className` prop
- **Design tokens with fallbacks** - Use n8n's CSS variables with fallback values
- **Only dynamic styles inline** - Use inline `style` prop only for dynamic/calculated values
- **Shared CSS files** - Create shared CSS files for common component styles (e.g., `FormElements.css`)

### When Inline Styles Are Acceptable
- **Dynamic positioning** - Values that change based on user interaction (drag/resize)
- **Calculated dimensions** - Heights/widths computed at runtime
- **Forwarded props** - Spreading `...props.style` for flexibility
- **Simple utilities** - Single-property utilities like `width: '100%'` (though CSS is preferred)

## Content Script Patterns for n8n Extension
- **Create React root** for injecting React apps into n8n pages
- **Use pointer-events: none** on container, **pointer-events: auto** on interactive elements
- **Check for existing elements** before injection to prevent duplicates
- **Handle page navigation** and dynamic content loading in n8n

## When Vanilla JS is Acceptable
- **Creating React root containers** (one-time setup)
- **Chrome extension APIs** (chrome.runtime, chrome.storage)
- **Browser APIs** (fetch, setTimeout, etc.)
- **Third-party library integration** (when no React wrapper exists)

## File Extensions
- Use `.tsx` for React components
- Use `.ts` for TypeScript utilities and services
- Update [vite.config.ts](mdc:vite.config.ts) when adding new entry points

## Why This Approach
- **Consistency** with React ecosystem and patterns
- **Type safety** with TypeScript integration
- **Maintainability** through component-based architecture
- **Performance** through React's optimization strategies
- **Developer experience** with familiar React patterns
