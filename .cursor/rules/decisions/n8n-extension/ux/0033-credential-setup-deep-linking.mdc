---
alwaysApply: false
description: Deep linking strategy for workflow and credential setup—seamless navigation from chat to n8n UI.
---

# Decision Record: Credential Setup Deep Linking

## Context

Due to n8n API limitations, the extension cannot:
- List existing credentials (requires session cookies, not API keys)
- Pre-check credential availability
- Auto-link credentials to workflow nodes

This requires a different UX approach for credential setup.

## Decision

Implement **deep linking** to provide seamless navigation from the extension chat to n8n's UI for workflow viewing and credential configuration.

## Implementation

### Deep Link Structure

**Workflow Link:**
```
http://localhost:5678/workflow/{workflowId}
```
Opens the workflow directly in n8n's editor.

**Credential Creation Link:**
```
http://localhost:5678/credentials/new/{credentialType}
```
Opens the credential creation page for a specific credential type.

### User Flow

1. **User clicks "Create & Open in n8n"**
   - Extension creates workflow via API
   - Receives workflow ID from n8n

2. **Extension provides deep links in chat:**
   ```
   ✅ Created workflow: [Open in n8n →]
   
   Next steps:
   1. Open the workflow above
   2. Configure credentials for these nodes:
      1. Slack API - [Set up credential →]
      2. Gmail OAuth2 - [Set up credential →]
   3. Activate your workflow!
   ```

3. **User clicks workflow link**
   - Opens workflow in n8n editor (new tab)
   - User can see all nodes and configuration
   - Visual context for credential setup

4. **User clicks credential links**
   - Opens credential creation page in n8n
   - Pre-filled with correct credential type
   - User provides values and saves

5. **User returns to workflow**
   - Connects saved credentials to nodes
   - Activates workflow

### UI Components

**PlanPreview Component:**
- Button text adapts: "Create Workflow" vs "Create & Open in n8n"
- Shows tip about receiving direct links
- Credential links point to creation pages

**Chat Messages:**
- Markdown links in chat responses
- Numbered step-by-step guide
- Direct workflow and credential URLs

## Benefits

### User Experience
- ✅ **No searching** - Direct link to created workflow
- ✅ **Clear guidance** - Step-by-step instructions with clickable links
- ✅ **Visual context** - User sees workflow structure in n8n
- ✅ **Reduced friction** - One-click navigation between chat and n8n
- ✅ **Non-interruptive** - User chooses when to open links

### Technical
- ✅ **Simple implementation** - URL generation only
- ✅ **No API limitations** - Works with current n8n API
- ✅ **No session management** - Relies on user's existing n8n session
- ✅ **Maintainable** - Minimal code, clear logic

## Constraints

### URL Format Requirements
- Base URL must be configurable (localhost vs cloud)
- Credential types must match n8n's credential type names
- Workflow IDs provided by n8n API after creation

### Browser Behavior
- Links open in new tabs (`target="_blank"`)
- User must be logged into n8n for links to work
- Extension does not track link clicks or completion

### Markdown Rendering
- Chat UI must support markdown link rendering
- Links format: `[Link text](url)`
- Future enhancement: Render as clickable elements

## Alternatives Considered

### API-Based Credential Creation
**Rejected** - Would require:
- Handling sensitive credential values in extension
- Trust issues from users
- Still can't detect duplicates
- Security concerns

### Status Monitoring
**Deferred** - Could implement:
- Poll workflow activation status
- Notify when workflow becomes active
- Requires additional complexity

### Content Script Session Access
**Too complex** - Would require:
- Accessing session cookies from page context
- Complex message passing
- Security implications
- Fragile to n8n UI changes

## Future Enhancements

### Possible Improvements
1. **Node-specific deep links** - Link directly to specific nodes needing credentials
2. **Return navigation** - Track when user completes setup and returns to chat
3. **Workflow activation detection** - Poll workflow status and notify on activation
4. **Visual workflow preview** - Show miniature workflow diagram in chat
5. **Credential templates** - Provide example values or configuration hints

### API Feature Requests
Request n8n team to add:
1. **Public credential listing** - Add GET support to `/api/v1/credentials`
2. **API key support for /rest/** - Allow API keys for internal endpoints
3. **Workflow status webhook** - Notify when workflow is activated

## References

- n8n API documentation: https://docs.n8n.io/api/
- n8n credential API: https://docs.n8n.io/api/api-reference/#tag/credential
- Related decision: 0011-n8n-api-integration.mdc

## Open Items

- Test deep linking with n8n Cloud instances
- Verify credential type names match across n8n versions
- Consider deep linking to specific nodes (if n8n supports it)
