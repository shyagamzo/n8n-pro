---
alwaysApply: false
description: n8n API client designâ€”authentication, workflow CRUD, pagination, retries, and error handling.
---

# Decision Record: n8n Extension API Integration Strategy

## API Version
Use n8n's REST API v1 for MVP integration. (n8n currently only provides v1 API)

## Core Operations (MVP)
- **Workflows**: List, create, read, update, delete workflows
- **Nodes**: Create, update, delete nodes within workflows
- **Connections**: Create and manage node connections
- **Credentials**: List (via internal REST API), create, delete, get schema
- **Executions**: Read execution status and results

## Authentication
- API Key authentication via n8n's REST API
- Store API key securely in extension storage
- Support for both self-hosted and n8n Cloud instances

## Data Flow
1. **Panel Open**: Auto-fetch list of existing workflows
2. **Workflow Creation**: Create new workflows with nodes and connections
3. **Workflow Updates**: Apply diffs to existing workflows
4. **Credential Check**: Verify required credentials exist before execution
5. **Execution Monitoring**: Track workflow execution status

## Error Handling
- Graceful handling of API rate limits
- Retry logic for transient failures
- Clear error messages for credential/auth issues
- Fallback for network connectivity issues

## Security Considerations
- Never store or transmit credential values
- Only check credential presence/metadata
- Validate API responses before processing
- Sanitize user inputs before API calls

## API Client Implementation
- Custom fetch wrapper around native fetch function
- Tailored to extension scenarios (CORS, error handling, retries)
- TypeScript-first with proper error types
- Built-in retry logic and rate limiting handling

### Key Features
- **Automatic retry**: Exponential backoff for transient failures
- **Request/response logging**: Debug logging for development and troubleshooting
- **Timeout handling**: Configurable timeouts for different operation types
- **CORS preflight management**: Handle cross-origin requests properly
- **Error classification**: Distinguish between network, auth, and API errors
- **Rate limiting**: Respect n8n API rate limits with backoff

## Integration Points
- Background service worker handles API calls
- Content script provides n8n instance detection
- Panel UI displays API status and results
- Options page manages API key configuration

## Reference Documentation
- n8n API docs: https://docs.n8n.io/api/
- Self-hosting guide: https://docs.n8n.io/hosting/
- Authentication: https://docs.n8n.io/api/authentication/

## Credentials API

### Public API Limitations
The public API (`/api/v1/credentials`) does not support listing credentials.
Reference: https://docs.n8n.io/api/api-reference/#tag/credential

### Internal REST API
n8n's UI uses an internal REST endpoint `/rest/credentials` that supports:
- **List credentials**: `GET /rest/credentials?includeScopes=true&includeData=false`
- **Filter by project**: `GET /rest/credentials?filter={"projectId":"..."}`
- **Authentication**: Uses same API key as public API

**Security Note**: We set `includeData=false` to avoid retrieving sensitive credential values.
Only credential metadata (id, name, type) is fetched.

## Open Items
- Rate limiting and retry strategies
- API version compatibility matrix
